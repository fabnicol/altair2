Programme sous licence CECILL 2.1 écrit par Fabrice Nicol

Utilisation
-----------

xhl2csv OPTIONS fichiers.xhl

OPTIONS :
-n nombre de bulletins mensuels attendus [calcul exact par défaut]
-t argument optionnel : type de base en sortie, soit 'standard', soit 'bulletins' [défaut bulletins].
-o argument obligatoire : fichier.csv, chemin complet du fichier de sortie [défaut 'Table.csv' avec -t].
-D argument obligatoire : répertoire complet du fichier de sortie [défaut '.' avec -t].
-d argument obligatoire : séparateur décimal [défaut . avec -t].
-s argument obligatoire : séparateur de champs [défaut , avec -t]/
-m sans argument : mémoire réservée. Estimation de la consommation de mémoire.
-j argument obligatoire : nombre de fils d'exécution (maximum 10).
-M sans argument : ne pas libérer la mémoire réservée en fin de programme.
-L argument obligatoire : chemin du log d'exécution du test de cohérence entre analyseurs C et XML.

Historique
----------

17 octobre 2014
   Mise au point des options suivante :
    [pas d'utilisation de -n] Mode économique en
    ressources RAM.

10 octobre 2014
   Mise au point des options suivantes :
   -n, -s, -d, -t, -j (multithreading)

15 septembre 2014
   Lancement du sous-projet comme partie intégrante du
   projet Altair.


Schéma XML

Ce programme est conçu pour analyser les schémas de paye définis par le site internet de l'application Xémélios :
    http://xemelios.org/schemas/cfg-paye/doc/index47.html


<xs:complexType name="TRemunerationPaye">
  <xs:sequence>
    <xs:element name="TraitBrut" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Traitement(s) Brut(s) principaux (plusieurs traitements en cas d'affectations multiples) - le traitement principal indiciaire doit être le premier élément mentionné dans la liste - éléments de traitement formant à la rémunération régulière hors indemnités, avantage en nature, supplément familial, rappel de rémunération</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="IndemResid" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Indemnité de Résidence</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="SupFam" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Supplément Familial</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="AvantageNature" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Avantage(s) en nature</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Indemnite" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Indemnités diverses</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="RemDivers" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Autres éléments de rémunérations (ne relevant pas des autres catégories)</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Deduction" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Deduction(s) sur rémunération Brute (y compris charges sociales - part salariale)</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Acompte" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Acompte(s) sur rémunération</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Rappel" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Rappel(s) sur rémunération (hors charges sociales part patronales et salariales)</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Retenue" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Retenue(s) sur rémunération Net</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Cotisation" type="TLignePaye" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Charges sociales (part patronale)</xs:documentation>
      </xs:annotation>
    </xs:element>
    <xs:element name="Commentaire" type="TLigneCommentaire" minOccurs="0" maxOccurs="unbounded">
      <xs:annotation>
        <xs:documentation>Commentaire entre différents éléments de rémunérations</xs:documentation>
      </xs:annotation>
    </xs:element>
  </xs:sequence>
</xs:complexType>

Définition des éléments
-----------------------

TraitBrut
---------

	Traitement(s) Brut(s) principaux (plusieurs traitements en cas d'affectations multiples)
	 le traitement principal indiciaire doit être le premier élément mentionné dans la liste - éléments de traitement
	 formant à la rémunération régulière hors  indemnités, avantage en nature, supplément familial,  rappel de rémunération

 <TraitBrut>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</TraitBrut>

Indemnité de résidence
----------------------

<IndemResid>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</IndemResid>

Supplément familial
-------------------

<SupFam>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</SupFam>

Avantage en nature
------------------

<AvantageNature>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</AvantageNature>

Indemnités diverses
-------------------

<Indemnite>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</Indemnite>

Rémunérations diverses
----------------------

<RemDivers>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</RemDivers>

Déductions sur rémunérations brutes
-----------------------------------

y compris charges sociales (part salariale)

<Deduction>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</Deduction>

Acompte
-------

<Acompte>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</Acompte>

Rappels sur rémunérations
-------------------------
hors charges sociales, parts patronale et salariale

<Rappel>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</Rappel>

Retenue sur rémunération nette
------------------------------

<Retenue>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</Retenue>

Charges sociales
----------------

Part patronale

<Cotisation>
  <Libelle V="">{1,1}</Libelle>
  <Code V="">{1,1}</Code>
  <Base V="">{0,1}</Base>
  <Taux V="">{0,1}</Taux>
  <NbUnite V="">{0,1}</NbUnite>
  <Mt V="">{1,1}</Mt>
  <PeriodeRef>{0,1}</PeriodeRef>
  <CodeCaisse V="">{0,1}</CodeCaisse>
  <Ordre V="">{1,1}</Ordre>
</Cotisation>



La rémunération brute doit donc être :

 Brut = TraitBrut + IndemResid + SupFam + Indemnite [y.compris NBI, improprement]+ RemDivers + Rappel + Deduction + Acompte [mais pas +Retenue]



