Montant.net.annuel.eqtp])
sum(Analyse.variations.par.exercice[Année == 2008
& Matricule %chin% sortants(2009)[[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE)/112
14126-12815
1311*112
1311*112/20000000
1311*112/20000000*100
s <- list(0)
e <- list(0)
noria <- rep(0, durée.sous.revue)
remplacements <- rep(0, durée.sous.revue)
f <- function(x) {
y <- x - début.période.sous.revue
s[[y]] <<- sortants(x)
e[[y]] <<- entrants(x)
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]]
-
- sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
prettyNum(noria[y],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) {
y <- x - début.période.sous.revue
remplacements[y] <<- min(e[[y]][[2]], s[[y]][[2]], na.rm=TRUE)
prettyNum(noria[y] * remplacements[y] / (masse.salariale.nette[y] * 10),
big.mark = " ",
digits = 3,
format = "fg")
}
#'#### Effet de noria
#'
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1"),
période[2:length(période)],
extra = "no",
f,
g)
#'
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]]
-
- sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]]
-
- sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
y <- x - début.période.sous.revue
s[[y]] <<- sortants(x)
e[[y]] <<- entrants(x)
s <- list(0)
e <- list(0)
noria <- rep(0, durée.sous.revue)
remplacements <- rep(0, durée.sous.revue)
y <- x - début.période.sous.revue
s[[y]] <<- sortants(x)
e[[y]] <<- entrants(x)
s
y
x
entrants(x)
s
e
y <- x - début.période.sous.revue
s[[y]] <- sortants(x)
e[[y]] <- entrants(x)
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
y <- x - début.période.sous.revue
s[[y]] <- sortants(x)
e[[y]] <- entrants(x)
noria[y] <- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
noria
source('~/Dev/Altair/Tests/Exemple/altair.R', echo=TRUE)
source('~/Dev/Altair/Tests/Exemple/altair.R', echo=TRUE)
#'### 4.2.2 Fonctionnaires
#'
#'#### Titulaires et stagiaires
f <- function(x) {
masse.salariale.nette[x - début.période.sous.revue + 1] <<-  sum(Analyse.variations.par.exercice[Année == x
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE"),
Montant.net.annuel.eqtp],
na.rm = TRUE) / 1000
prettyNum(masse.salariale.nette[x - début.période.sous.revue + 1],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) prettyNum(sum(Analyse.variations.par.exercice[Année == x & (Statut == "TITULAIRE" | Statut == "STAGIAIRE"),
Montant.net.annuel.eqtp],
na.rm = TRUE) / effectifs[[as.character(x)]]["ETPT_fonct"],
big.mark = " ",
digits = 1,
format = "fg")
#'
#'#### Rémunération
#'
Tableau.vertical(c(étiquette.année, "Rém. nette totale (k&euro;)", "Rém. nette par EQTP (&euro;)"),
période,
extra = "variation",
f,
g)
#'
f <- function(x) {
y <- x - début.période.sous.revue
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE")
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[3]] -  sum(Analyse.variations.par.exercice[Année == x- 1
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE")
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[3]]
prettyNum(noria[y],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) {
y <- x - début.période.sous.revue
remplacements[y] <<- min(e[[y]][[3]], s[[y]][[3]], na.rm=TRUE)
prettyNum(noria[y] * remplacements[y] / (masse.salariale.nette[y] * 10),
big.mark = " ",
digits = 3,
format = "fg")
}
#'#### Effet de noria
#'
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1"),
période[2:length(période)],
extra = "no",
f,
g)
#'
#'######
masse.salariale.nette <- rep(0, durée.sous.revue)
f <- function(x) prettyNum(masse.salariale.nette[x - début.période.sous.revue + 1] <<-
sum(Analyse.variations.par.exercice[Année == x,
Montant.net.annuel.eqtp],
na.rm = TRUE) / 1000,
big.mark = " ",
digits = 5,
format = "fg")
g <- function(x) prettyNum(sum(Analyse.variations.par.exercice[Année == x,
Montant.net.annuel.eqtp],
na.rm = TRUE) / effectifs[[as.character(x)]]["ETPT"],
big.mark = " ",
digits = 1,
format = "fg")
#'
#'#### Rémunération nette et effet de noria sur salaires nets
#'
#'#### Rémunération
#'
Tableau.vertical(c(étiquette.année, "Rém. nette totale (k&euro;)", "Rém. nette par EQTP (&euro;)"),
période,
extra = "variation",
f,
g)
entrants <- function(x)   {
A <- setdiff(Analyse.variations.par.exercice[Année == x , Matricule],
Analyse.variations.par.exercice[Année == x -1, Matricule])
#   nb.fonct <- nrow(Analyse.variations.par.exercice[Matricule %chin% A
#                                                    & (Statut == "TITULAIRE" | Statut == "STAGIAIRE")])
B <- unique(Bulletins.paie[Année == x
& Matricule %chin% A, .(Année, quotité, Matricule, Mois, Statut)], by = NULL)
eqtp.agent <- B[ , sum(quotité, na.rm=TRUE)] / 12
eqtp.fonct <- B[Statut == "TITULAIRE" | Statut == "STAGIAIRE", sum(quotité, na.rm=TRUE)] / 12
list(A, eqtp.agent, eqtp.fonct)
}
sortants <- function(x)   {
A <- setdiff(Analyse.variations.par.exercice[Année == x-1 , Matricule],
Analyse.variations.par.exercice[Année == x, Matricule])
B <- unique(Bulletins.paie[Année == x - 1
& Matricule %chin% A, .(Année, quotité, Matricule, Mois, Statut)], by = NULL)
eqtp.agent <- B[ , sum(quotité, na.rm=TRUE)] / 12
eqtp.fonct <- B[Statut == "TITULAIRE" | Statut == "STAGIAIRE", sum(quotité, na.rm=TRUE)] / 12
list(A, eqtp.agent, eqtp.fonct)
}
#'  Montant.net.annuel.eqtp
s <- list(0)
e <- list(0)
noria <- rep(0, durée.sous.revue)
remplacements <- rep(0, durée.sous.revue)
f <- function(x) {
y <- x - début.période.sous.revue
s[[y]] <<- sortants(x)
e[[y]] <<- entrants(x)
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
prettyNum(noria[y],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) {
y <- x - début.période.sous.revue
remplacements[y] <<- min(e[[y]][[2]], s[[y]][[2]], na.rm=TRUE)
prettyNum(noria[y] * remplacements[y] / (masse.salariale.nette[y] * 10),
big.mark = " ",
digits = 3,
format = "fg")
}
#'#### Effet de noria
#'
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1"),
période[2:length(période)],
extra = "no",
f,
g)
masse.salariale.nette <- rep(0, durée.sous.revue)
f <- function(x) prettyNum(masse.salariale.nette[x - début.période.sous.revue + 1] <<-
sum(Analyse.variations.par.exercice[Année == x,
Montant.net.annuel.eqtp],
na.rm = TRUE) / 1000,
big.mark = " ",
digits = 5,
format = "fg")
g <- function(x) prettyNum(sum(Analyse.variations.par.exercice[Année == x,
Montant.net.annuel.eqtp],
na.rm = TRUE) / effectifs[[as.character(x)]]["ETPT"],
big.mark = " ",
digits = 1,
format = "fg")
#'
#'#### Rémunération nette et effet de noria sur salaires nets
#'
#'#### Rémunération
#'
Tableau.vertical(c(étiquette.année, "Rém. nette totale (k&euro;)", "Rém. nette par EQTP (&euro;)"),
période,
extra = "variation",
f,
g)
entrants <- function(x)   {
A <- setdiff(Analyse.variations.par.exercice[Année == x , Matricule],
Analyse.variations.par.exercice[Année == x -1, Matricule])
nb.fonct <- nrow(Analyse.variations.par.exercice[Matricule %chin% A
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE")])
B <- unique(Bulletins.paie[Année == x
& Matricule %chin% A,
.(Année, quotité, Matricule, Mois, Statut)],
by = NULL)
eqtp.agent <- B[ , sum(quotité, na.rm=TRUE)] / 12
eqtp.fonct <- B[Statut == "TITULAIRE" | Statut == "STAGIAIRE", sum(quotité, na.rm=TRUE)] / 12
#list(A, eqtp.agent, eqtp.fonct)
list(A, length(A), nb.fonct)
}
sortants <- function(x)   {
A <- setdiff(Analyse.variations.par.exercice[Année == x-1 , Matricule],
Analyse.variations.par.exercice[Année == x, Matricule])
B <- unique(Bulletins.paie[Année == x - 1
& Matricule %chin% A, .(Année, quotité, Matricule, Mois, Statut)], by = NULL)
nb.fonct <- nrow(Analyse.variations.par.exercice[Matricule %chin% A
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE")])
#eqtp.agent <- B[ , sum(quotité, na.rm=TRUE)] / 12
#eqtp.fonct <- B[Statut == "TITULAIRE" | Statut == "STAGIAIRE", sum(quotité, na.rm=TRUE)] / 12
#list(A, eqtp.agent, eqtp.fonct)
list(A, length(A), nb.fonct)
}
#'  Montant.net.annuel.eqtp
s <- list(0)
e <- list(0)
noria <- rep(0, durée.sous.revue)
remplacements <- rep(0, durée.sous.revue)
f <- function(x) {
y <- x - début.période.sous.revue
s[[y]] <<- sortants(x)
e[[y]] <<- entrants(x)
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
prettyNum(noria[y],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) {
y <- x - début.période.sous.revue
remplacements[y] <<- min(e[[y]][[2]], s[[y]][[2]], na.rm=TRUE)
prettyNum(noria[y] * remplacements[y] / (masse.salariale.nette[y] * 10),
big.mark = " ",
digits = 3,
format = "fg")
}
#'#### Effet de noria
#'
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1"),
période[2:length(période)],
extra = "no",
f,
g)
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
noria[y] <- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
noria
y
noria[4]
#'
masse.salariale.nette <- rep(0, durée.sous.revue)
f <- function(x) prettyNum(masse.salariale.nette[x - début.période.sous.revue + 1] <<-
sum(Analyse.variations.par.exercice[Année == x,
Montant.net.annuel.eqtp],
na.rm = TRUE) / 1000,
big.mark = " ",
digits = 5,
format = "fg")
g <- function(x) prettyNum(sum(Analyse.variations.par.exercice[Année == x,
Montant.net.annuel.eqtp],
na.rm = TRUE) / effectifs[[as.character(x)]]["ETPT"],
big.mark = " ",
digits = 1,
format = "fg")
#'
#'#### Rémunération nette et effet de noria sur salaires nets
#'
#'#### Rémunération
#'
Tableau.vertical(c(étiquette.année, "Rém. nette totale (k&euro;)", "Rém. nette par EQTP (&euro;)"),
période,
extra = "variation",
f,
g)
entrants <- function(x)   {
A <- setdiff(Analyse.variations.par.exercice[Année == x , Matricule],
Analyse.variations.par.exercice[Année == x -1, Matricule])
#   nb.fonct <- nrow(Analyse.variations.par.exercice[Matricule %chin% A
#                                                    & (Statut == "TITULAIRE" | Statut == "STAGIAIRE")])
B <- unique(Bulletins.paie[Année == x
& Matricule %chin% A, .(Année, quotité, Matricule, Mois, Statut)], by = NULL)
eqtp.agent <- B[ , sum(quotité, na.rm=TRUE)] / 12
eqtp.fonct <- B[Statut == "TITULAIRE" | Statut == "STAGIAIRE", sum(quotité, na.rm=TRUE)] / 12
list(A, eqtp.agent, eqtp.fonct)
}
sortants <- function(x)   {
A <- setdiff(Analyse.variations.par.exercice[Année == x-1 , Matricule],
Analyse.variations.par.exercice[Année == x, Matricule])
B <- unique(Bulletins.paie[Année == x - 1
& Matricule %chin% A, .(Année, quotité, Matricule, Mois, Statut)], by = NULL)
eqtp.agent <- B[ , sum(quotité, na.rm=TRUE)] / 12
eqtp.fonct <- B[Statut == "TITULAIRE" | Statut == "STAGIAIRE", sum(quotité, na.rm=TRUE)] / 12
list(A, eqtp.agent, eqtp.fonct)
}
#'  Montant.net.annuel.eqtp
s <- list(0)
e <- list(0)
noria <- rep(0, durée.sous.revue)
remplacements <- rep(0, durée.sous.revue)
f <- function(x) {
y <- x - début.période.sous.revue
s[[y]] <<- sortants(x)
e[[y]] <<- entrants(x)
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[2]] - sum(Analyse.variations.par.exercice[Année == x- 1
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[2]]
prettyNum(noria[y],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) {
y <- x - début.période.sous.revue
remplacements[y] <<- min(e[[y]][[2]], s[[y]][[2]], na.rm=TRUE)
prettyNum(noria[y] * remplacements[y] / (masse.salariale.nette[y] * 10),
big.mark = " ",
digits = 3,
format = "fg")
}
#'#### Effet de noria
#'
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1", "Remplacements"),
période[2:length(période)],
extra = "no",
f,
g,
function(x) remplacements[x - début.période.sous.revue])
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1", "Remplacements"),
période[2:length(période)],
extra = "no",
f,
g,
prettyNum(function(x) remplacements[x - début.période.sous.revue], digits=0, format="f"))
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1", "Remplacements"),
période[2:length(période)],
extra = "no",
f,
g,
function(x) prettyNum(remplacements[x - début.période.sous.revue], digits=0, format="f"))
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1", "Remplacements EQTP"),
période[2:length(période)],
extra = "no",
f,
g,
function(x) prettyNum(remplacements[x - début.période.sous.revue], digits=0, format="f"))
f <- function(x) {
masse.salariale.nette[x - début.période.sous.revue + 1] <<-  sum(Analyse.variations.par.exercice[Année == x
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE"),
Montant.net.annuel.eqtp],
na.rm = TRUE) / 1000
prettyNum(masse.salariale.nette[x - début.période.sous.revue + 1],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) prettyNum(sum(Analyse.variations.par.exercice[Année == x & (Statut == "TITULAIRE" | Statut == "STAGIAIRE"),
Montant.net.annuel.eqtp],
na.rm = TRUE) / effectifs[[as.character(x)]]["ETPT_fonct"],
big.mark = " ",
digits = 1,
format = "fg")
#'
#'#### Rémunération
#'
Tableau.vertical(c(étiquette.année, "Rém. nette totale (k&euro;)", "Rém. nette par EQTP (&euro;)"),
période,
extra = "variation",
f,
g)
#'
f <- function(x) {
y <- x - début.période.sous.revue
noria[y] <<- sum(Analyse.variations.par.exercice[Année == x
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE")
& Matricule %chin% e[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / e[[y]][[3]] -  sum(Analyse.variations.par.exercice[Année == x- 1
& (Statut == "TITULAIRE" | Statut == "STAGIAIRE")
& Matricule %chin% s[[y]][[1]],
Montant.net.annuel.eqtp],
na.rm = TRUE) / s[[y]][[3]]
prettyNum(noria[y],
big.mark = " ",
digits = 5,
format = "fg")
}
g <- function(x) {
y <- x - début.période.sous.revue
remplacements[y] <<- min(e[[y]][[3]], s[[y]][[3]], na.rm=TRUE)
prettyNum(noria[y] * remplacements[y] / (masse.salariale.nette[y] * 10),
big.mark = " ",
digits = 3,
format = "fg")
}
#'#### Effet de noria
#'
Tableau.vertical(c(étiquette.année,  "Effet noria EQTP (&euro; année N)", "En % de la rém. nette totale N-1", "Remplacements EQTP"),
période[2:length(période)],
extra = "no",
f,
g,
function(x) prettyNum(remplacements[x - début.période.sous.revue], digits=0, format="f"))
