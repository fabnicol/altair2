<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Procédure de récupération</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="altaïr.bmp"/></td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Recherche" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Recherche');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_recover.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Procédure de récupération </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="connexion_blank"></a>
En cas d'impossibilité de se connecter</h1>
<p>Si l’écran graphique de connexion aux comptes (login) n’apparaît pas, le système est sérieusement compromis, ce qui peut arriver en cas de redémarrage forcé au cours d'une actualisation automatique non terminée.<br />
Il faut recloner l'ensemble du système.<br />
 </p>
<h1><a class="anchor" id="connexion_ok"></a>
Cas général</h1>
<p>Si cet écran apparaît, ce qui est le plus souvent le cas, mais qu’il y a seulement un problème de connexion à un ou plusieurs comptes (login), procéder comme suit :<br />
<b>EtapeA</b><br />
</p><ol type="1">
<li>Préalablement, télécharger sous Windows le paquet altair.zip à l’<a href="https://www.dropbox.com/s/35696fw5w0upleo/altair.zip?dl=0">adresse</a> ou sur toute adresse réseau indiquée par le gestionnaire du logiciel.<br />
</li>
<li>Copier ce paquet sur la clé USB3 préalablement complètement nettoyée.<pre></pre></li>
</ol>
<p><b>Etape B</b><br />
</p><ol type="1">
<li>Aller sur le PC linux.</li>
<li>Déconnecter tous les périphériques éventuels (autres clés, cdrom, etc.)</li>
<li>Démarrer sans la clé USB3 dans son port USB. Attendre que l’écran de login apparaisse. Puis taper ensemble les touches : <b>Ctrl + Alt + F1</b></li>
<li>Puis au login : <br />
 fabpc login : <br />
 rentrer : root <br />
 Puis rentrer le mot de passe root <br />
 On obtient l’invite <pre style="color:red;">fabpc ~#</pre></li>
</ol>
<p><b>Etape C</b><br />
</p><ol type="1">
<li>Une fois l’invite en ligne de commande comme ci-dessus on est en mode administrateur root.</li>
<li>Insérer alors la clé USB3 dans un port USB de façade.</li>
<li>La monter : <br />
 <span style="color:red;">fabpc ~#</span> mkdir /mnt <br />
 <span style="color:red;">fabpc ~#</span> mount –o nonempty /dev/sdb1 /mnt</li>
<li>Vérifier si altair.zip est bien reconnue sur la clé :<br />
 <span style="color:red;">fabpc ~#</span> ls /mnt</li>
<li>Aller sur la clé :<br />
 <span style="color:red;">fabpc ~#</span> cd /mnt</li>
<li>Décompresser le paquet :<br />
 <span style="color:red;">fabpc ~#</span> unzip –o altair.zip</li>
<li>Détruire le répertoire altair déficient :<br />
 <span style="color:red;">fabpc ~#</span> rm –rvf /home/fab/Dev/altair</li>
<li>Copier les fichiers de la clé vers le PC :<br />
 <span style="color:red;">fabpc ~#</span> cp –rvf altair /home/fab/Dev</li>
<li>Eteindre : <br />
 <span style="color:red;">fabpc ~#</span> shutdown –h now <pre></pre></li>
</ol>
<p><b>Etape D</b><br />
</p><ol type="1">
<li>Enlever la clé.</li>
<li>Connecter le port Ethernet (vérifier la connexion préalablement sous Windows etc.).</li>
<li>Redémarrer. Le PC est alors en mode d’actualisation automatique.<br />
 Le laisser impérativement s’éteindre seul.</li>
<li>Redémarrer lorsqu’il est éteint et surtout pas avant.</li>
<li>Tester. <pre></pre></li>
</ol>
<p><b>Etapes optionnelles</b><br />
En cas d’échec à l’actualisation du PC.</p><ol type="1">
<li>Répéter B.<br />
</li>
<li>Insérer la clé. Répéter les deux premières lignes de commande de C.<br />
</li>
<li>Copier le fichier version.log sur la clé :<br />
<span style="color:red;">fabpc ~#</span> cp /home/Public/version.log /mnt <br />
Ce fichier est un log des procédures d’actualisation. <br />
</li>
<li>Pour vérifier qu’une actualisation automatique est en cours (ou non) :<br />
<span style="color:red;">fabpc ~#</span> tail /home/Public/version.log <br />
Si oui s’affiche un message :<br />
<ul>
<li>Actualisation de l’application Altaïr…<br />
</li>
<li>Actualisation du dépôt fab… <br />
Puis du dépôt jf puis quelques autres messages.<br />
Sinon s’affiche :<br />
"***" Pas de mise à jour "***"</li>
</ul>
</li>
<li>Copier le fichier log sur la clé :<br />
<span style="color:red;">fabpc ~#</span> cp /home/Public/log /mnt <br />
Ce fichier est un log des connexions.</li>
<li>Copier le fichier VERSION sur la clé :<br />
<span style="color:red;">fabpc ~#</span> cp /home/Public/VERSION /mnt <br />
Ce fichier est le numéro de version normalement téléchargé depuis le dépôt Gitlabjf. S’il n’est pas aligné, cela signifie que la connexion internet est dysfonctionnelle.</li>
</ol>
<h1><a class="anchor" id="connexion_desktop"></a>
Si la connexion au compte d'administration est possible</h1>
<p>Il est alors possible d'utiliser les fonctionnalités de KDE pour simplifier les manipulations précédentes.<br />
</p><ol type="1">
<li>Mettre le paquet <code>altair.zip</code> sur la clé USB.</li>
<li>Avec la clé connectée au port USB, se connecter au compte <b>fab</b> (administrateur)</li>
<li>Ouvrir le gestionnaire de données et allez dans <b>Clé USB3</b>.</li>
<li>Copier-coller <code>altair.zip</code> de <b>Clé USB3</b> dans <code>/home/fab/Dev</code> (=répertoire Dev dans Dossier personnel). On peut faire <b>Ctrl+C</b> puis <b>Ctrl+V</b> comme sous windows.</li>
<li>Ecraser <code>/home/fab/Dev/altair</code> (<b>Shift + suppr + confirmer</b>)</li>
<li>Décompresser <code>/home/fab/Dev/altair.zip</code> ce qui donnera un nouveau <code>/home/fab/Dev/altair</code> <br />
 Il suffit pour cela de faire clic droit sur <b>altair.zip &gt; Extraire &gt; Extraire l’archive ici, détecter le sous-dossier</b>.</li>
<li>Refaire une actualisation automatique sans clé, sans connexion à aucun compte. </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Généré le Jeudi 10 Mai 2018 02:08:46 par
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
