var FontInspector=function(){function h(){for(var c=document.querySelectorAll("div["+b+"]"),a=0,n=c.length;a<n;++a)c[a].className="debuggerHideText"}function i(c,a){for(var n=document.querySelectorAll("div["+b+"="+c+"]"),e=0,g=n.length;e<g;++e)n[e].className=a?"debuggerShowText":"debuggerHideText"}function d(c){if(c.target.dataset.fontName&&"DIV"===c.target.tagName.toUpperCase())for(var c=c.target.dataset.fontName,a=document.getElementsByTagName("input"),b=0;b<a.length;++b){var e=a[b];e.dataset.fontName==
c&&(e.checked=!e.checked,i(c,e.checked),e.scrollIntoView())}}var g,f=!1,b="data-font-name";return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(){var c=this.panel;c.setAttribute("style","padding: 5px;");var a=document.createElement("button");a.addEventListener("click",h);a.textContent="Refresh";c.appendChild(a);g=document.createElement("div");c.appendChild(g)},enabled:!1,get active(){return f},set active(c){if(f=c)document.body.addEventListener("click",d,!0),h();else{document.body.removeEventListener("click",
d,!0);for(var c=document.querySelectorAll("div["+b+"]"),a=0,n=c.length;a<n;++a)c[a].className=""}},fontAdded:function(c,a){var b=function(a,b){for(var c=document.createElement("table"),e=0;e<b.length;e++){var d=document.createElement("tr"),f=document.createElement("td");f.textContent=b[e];d.appendChild(f);f=document.createElement("td");f.textContent=a[b[e]].toString();d.appendChild(f);c.appendChild(d)}return c}(c,["name","type"]),e=/url\(['"]?([^\)"']+)/.exec(a),f=c.loadedName,d=document.createElement("div"),
j=document.createElement("span");j.textContent=f;var l=document.createElement("a");l.href=e[1];l.textContent="Download";e=document.createElement("a");e.href="";e.textContent="Log";e.addEventListener("click",function(a){a.preventDefault();console.log(c)});var k=document.createElement("input");k.setAttribute("type","checkbox");k.dataset.fontName=f;k.addEventListener("click",function(a,b){return function(){i(b,a.checked)}}(k,f));d.appendChild(k);d.appendChild(j);d.appendChild(document.createTextNode(" "));
d.appendChild(l);d.appendChild(document.createTextNode(" "));d.appendChild(e);d.appendChild(b);g.appendChild(d);setTimeout(function(){this.active&&h()}.bind(this),2E3)}}}(),StepperManager=function(){var h=[],i=null,d=null,g=null,f={};return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(){var b=this;this.panel.setAttribute("style","padding: 5px;");d=document.createElement("div");g=document.createElement("select");g.addEventListener("change",function(){b.selectStepper(this.value)});
d.appendChild(g);i=document.createElement("div");this.panel.appendChild(d);this.panel.appendChild(i);sessionStorage.getItem("pdfjsBreakPoints")&&(f=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints")))},enabled:!1,active:!1,create:function(b){var c=document.createElement("div");c.id="stepper"+b;c.setAttribute("hidden",!0);c.className="stepper";i.appendChild(c);var a=document.createElement("option");a.textContent="Page "+(b+1);a.value=b;g.appendChild(a);c=new Stepper(c,b,f[b]||[]);h.push(c);1===
h.length&&this.selectStepper(b,!1);return c},selectStepper:function(b,c){c&&this.manager.selectPanel(1);for(var a=0;a<h.length;++a){var d=h[a];d.pageIndex==b?d.panel.removeAttribute("hidden"):d.panel.setAttribute("hidden",!0)}d=g.options;for(a=0;a<d.length;++a){var e=d[a];e.selected=e.value==b}},saveBreakPoints:function(b,c){f[b]=c;sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(f))}}}(),Stepper=function(){function h(b,c){var a=document.createElement(b);c&&(a.textContent=c);return a}function i(b){for(var c=
"",a=0;a<b.length;a++)c=null===b[a]?c+" ":c+b[a].fontChar;return c}function d(b,c,a){this.panel=b;this.breakPoint=0;this.nextBreakPoint=null;this.pageIndex=c;this.breakPoints=a;this.currentIdx=-1;this.operatorListIdx=0}var g=null,f={showText:0,showSpacedText:0,nextLineShowText:0,nextLineSetSpacingShowText:2};d.prototype={init:function(){var b=this.panel,c=h("div","c=continue, s=step"),a=h("table");c.appendChild(a);a.cellSpacing=0;var d=h("tr");a.appendChild(d);d.appendChild(h("th","Break"));d.appendChild(h("th",
"Idx"));d.appendChild(h("th","fn"));d.appendChild(h("th","args"));b.appendChild(c);this.table=a;if(!g){g=Object.create(null);for(var e in PDFJS.OPS)g[PDFJS.OPS[e]]=e}},updateOperatorList:function(b){for(var c=this,a=this.operatorListIdx;a<b.fnArray.length;a++){var d=h("tr");d.className="line";d.dataset.idx=a;this.table.appendChild(d);var e=-1!=this.breakPoints.indexOf(a),m=b.argsArray[a]?b.argsArray[a]:[],o=h("td"),j=h("input");j.type="checkbox";j.className="points";j.checked=e;j.onclick=function(a){return function(){this.checked?
c.breakPoints.push(a):c.breakPoints.splice(c.breakPoints.indexOf(a),1);StepperManager.saveBreakPoints(c.pageIndex,c.breakPoints)}}(a);o.appendChild(j);d.appendChild(o);d.appendChild(h("td",a.toString()));e=g[b.fnArray[a]];o=m;if(e in f){var j=f[e],l=m[j],o=m.slice();if("showSpacedText"===e)for(var m=[],k=0;k<l.length;k++)"number"===typeof l[k]?m.push(l[k]):m.push(i(l[k]));else m=i(l);o[j]=m}d.appendChild(h("td",e));d.appendChild(h("td",JSON.stringify(o)))}},getNextBreakPoint:function(){this.breakPoints.sort(function(b,
a){return b-a});for(var b=0;b<this.breakPoints.length;b++)if(this.breakPoints[b]>this.currentIdx)return this.breakPoints[b];return null},breakIt:function(b,c){StepperManager.selectStepper(this.pageIndex,!0);var a=this,d=document;a.currentIdx=b;var e=function(b){switch(b.keyCode){case 83:d.removeEventListener("keydown",e,!1);a.nextBreakPoint=a.currentIdx+1;a.goTo(-1);c();break;case 67:d.removeEventListener("keydown",e,!1),b=a.getNextBreakPoint(),a.nextBreakPoint=b,a.goTo(-1),c()}};d.addEventListener("keydown",
e,!1);a.goTo(b)},goTo:function(b){for(var c=this.panel.getElementsByClassName("line"),a=0,d=c.length;a<d;++a){var e=c[a];e.dataset.idx==b?(e.style.backgroundColor="rgb(251,250,207)",e.scrollIntoView()):e.style.backgroundColor=null}}};return d}(),Stats=function(){function h(d){for(;d.hasChildNodes();)d.removeChild(d.lastChild)}function i(g){for(var f=0,b=d.length;f<b;++f)if(d[f].pageNumber===g)return f;return!1}var d=[];return{id:"Stats",name:"Stats",panel:null,manager:null,init:function(){this.panel.setAttribute("style",
"padding: 5px;");PDFJS.enableStats=!0},enabled:!1,active:!1,add:function(g,f){if(f){var b=i(g);!1!==b&&(this.panel.removeChild(d[b].div),d.splice(b,1));b=document.createElement("div");b.className="stats";var c=document.createElement("div");c.className="title";c.textContent="Page: "+g;var a=document.createElement("div");a.textContent=f.toString();b.appendChild(c);b.appendChild(a);d.push({pageNumber:g,div:b});d.sort(function(a,b){return a.pageNumber-b.pageNumber});h(this.panel);b=0;for(c=d.length;b<
c;++b)this.panel.appendChild(d[b].div)}}}}(),PDFBug=function(){var h=[],i=null;return{tools:[FontInspector,StepperManager,Stats],enable:function(d){var g=!1,f=this.tools;1===d.length&&"all"===d[0]&&(g=!0);for(var b=0;b<f.length;++b){var c=f[b];if(g||-1!==d.indexOf(c.id))c.enabled=!0}g||f.sort(function(a,b){var c=d.indexOf(a.id),c=0>c?f.length:c,g=d.indexOf(b.id),g=0>g?f.length:g;return c-g})},init:function(){var d=document.createElement("div");d.id="PDFBug";var g=document.createElement("div");g.setAttribute("class",
"controls");d.appendChild(g);var f=document.createElement("div");f.setAttribute("class","panels");d.appendChild(f);var b=document.getElementById("viewerContainer");b.appendChild(d);b.style.right="300px";for(var d=this.tools,c=this,b=0;b<d.length;++b){var a=d[b],i=document.createElement("div"),e=document.createElement("button");e.textContent=a.name;e.addEventListener("click",function(a){return function(b){b.preventDefault();c.selectPanel(a)}}(b));g.appendChild(e);f.appendChild(i);a.panel=i;a.manager=
this;a.enabled?a.init():i.textContent=a.name+' is disabled. To enable add  "'+a.id+'" to the pdfBug parameter and refresh (seperate multiple by commas).';h.push(e)}this.selectPanel(0)},selectPanel:function(d){if(d!==i){i=d;for(var g=this.tools,f=0;f<g.length;++f)f==d?(h[f].setAttribute("class","active"),g[f].active=!0,g[f].panel.removeAttribute("hidden")):(h[f].setAttribute("class",""),g[f].active=!1,g[f].panel.setAttribute("hidden","true"))}}}}();
