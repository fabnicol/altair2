
```{r }
Résumé(c("Âge des personnels <br>au 31/12/" %+% début.période.sous.revue,
         "Effectif",
         "Âge des personnels <br>au 31/12/" %+% fin.période.sous.revue,
         "Effectif"),
       list(Bulletins.avant[ , age], 
            Bulletins.après[ , age]),
       extra = "length",
       align = 'c',
       type =  "standard")
```



```{r fig.height=9.7, fig.width=8.4}


if (longueur.non.na(avant) > 0 && longueur.non.na(après) > 0) {
  
  pyramide_ages(avant, après, titre)

  
  H0 <- avant[ , .(Hommes = sum(Hommes, na.rm = TRUE), 
                   Femmes = sum(Femmes, na.rm = TRUE)),
                 by = floor(age / 5)][ 
               , Total := Hommes + Femmes]
 
  H1 <- après[ , .(Hommes = sum(Hommes, na.rm = TRUE), 
                   Femmes = sum(Femmes, na.rm = TRUE)),
               by = floor(age / 5)][ 
                 , Total := Hommes + Femmes]
  
  H <- H1 - H0
  
}
```



```{r fig.height=9.7, fig.width=8.4}

if (longueur.non.na(H$Total) > 0) {
  plot(c(min(H$Total), max(H$Total)), c(-1,20), type = "n", frame = FALSE, axes = FALSE, xlab = "", ylab = "",
       main = "Evolution des effectifs par tranche d'âge")
  
  barplot(H$Total, 
          width = 1.5,
          names.arg=c("15-20", 
                      "20-25",
                      "25-30",
                      "30-35",
                      "35-40",
                      "40-45",
                      "45-50",
                      "50-55",
                      "55-60",
                      "60-65",
                      "65-70"),
          xlab = "Variation d'effectifs",
          xlim = c(min(H$Total), max(H$Total)),
          ylab = "Tranche d'âge",
          col  = "lightgreen",
          horiz = TRUE,
          add = TRUE,
          xpd  = FALSE,
          cex.names = 0.8)
  

  barplot(H$Femmes, 
          width=1.5,
          xlim = c(min(H$Total), max(H$Total)),
          col  = "deeppink",
          horiz = TRUE,
          density = 10,
          xpd  = FALSE,
          add = TRUE)
  
  legend("bottomleft", fill=c("lightgreen", "deeppink"), density=c(NA, 20),
         legend=c("Total " %+% début.période.sous.revue %+% "-" %+% fin.période.sous.revue,
                  "    dont Femmes "), cex = 0.8)
  

}
```


