{
    "contents" : "#----------------------------------------------------------------------------------------------------------------------\n##\n#  Fonctions auxiliaires\n##\n\n# Trouve le numéro de la ligne à laquelle se situe la liste des noms de variables\n# en recherchant soit le mot \"Matricule\" soit une expression du type \"Code...\"\n# Il faudra déduire ce \"skip\" du read.csv2 pour récupérer proprement les noms de variable\n\n# Pour cela on scanne les 25 premières lignes de la table une première fois\n\n\nscan.prime <- function(texte)\n{\n\tunique(Bdp.ldp[grep(paste0(\".*(\", texte,\").*\"), Bdp.ldp$Libellé), c(\"Matricule\", \"Libellé\", \"Libellé\")])\n}\n\ntrouver.valeur.skip <-  function(chemin.table) \n  max(\n    sapply(\n      read.csv2(chemin.table, nrows=25),\n      function(x) \n      {\n        m <- match(\"Matricule\", x, nomatch=0 ) \n        if (m == 0)\n          m <- pmatch(\"Code\", x, nomatch=0, duplicates.ok=FALSE ) \n        return(m)\n      }\n    ))\n\n\nselectionner.cle.matricule <-  function(Base1, Base2) \n  subset(Base1, \n         select=c(\"Matricule\", setdiff(names(Base1),names(Base2))))\n\nselectionner.cle.matricule.mois <-  function(Base1, Base2) \n  subset(Base1, \n         select=c(\"Matricule\",\"Mois\",\n                  setdiff(names(Base1),names(Base2))))\n\nchemin <-  function(fichier) \n  file.path(chemin.dossier, fichier)\n\nread.csv.skip <- function(x) \n{\n  chem <- chemin(x)\n  read.csv2(chem, skip=trouver.valeur.skip(chem))\n}\n\nsauv.base <- function(x) write.csv2(x, paste0(chemin(deparse(substitute(x))), \".csv\"), row.names=FALSE)\n\n\n# Utiliser une assignation globale \n# car la fonction anonyme ne comporte que de variables locales\n\nRead.csv <- function(vect.chemin) \n{\n  Read.csv.result <- data.frame(NULL)\n  Vectorize(function(x) Read.csv.result <<- rbind(Read.csv.result, read.csv.skip(x)))(vect.chemin)\n  Read.csv.result\n}\n\npretty.print <- function(x) cat(gsub(\".\", \" \",deparse(substitute(x)), fixed=TRUE), \"   \", x,\"\\n\")\n\n\n#-----------------------------------------------------------------------------------------------------------------\n",
    "created" : 1395407419870.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4166006982",
    "id" : "677B5847",
    "lastKnownWriteTime" : 1395408132,
    "path" : "G:/Equipe NICOL/2013/SIERG/GESTION/2-Travail/OBSERVATIONS/ANALYSES/RH/bibliothèque.fonctions.paie.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}